

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.ico">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="Upward, not Northward.">
  <meta name="author" content="bleem">
  <meta name="keywords" content="漠然,bleem,mritd">
  <title>Kubernetes 1.12 新的插件机制 - bleem</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/atom-one-dark.min.css" />
    
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_pf9vaxs7x7b.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="bleem" type="application/atom+xml">
<link rel="alternate" href="/rss.xml" title="bleem" type="application/rss+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>bleem</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/friends/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/img/default.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container page-header text-center fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2018-11-30 00:05" pubdate>
        2018年11月30日 凌晨
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      1.7k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      22
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" id="post">
            <!-- SEO header -->
            <h1 style="display: none">Kubernetes 1.12 新的插件机制</h1>
            
            <div class="markdown-body" id="post-body">
              <blockquote>
<p>在很久以前的版本研究过 kubernetes 的插件机制，当时弄了一个快速切换 <code>namespace</code> 的小插件；最近把自己本机的 kubectl 升级到了 1.12，突然发现插件不能用了；撸了一下文档发现插件机制彻底改了…</p>
</blockquote>
<h2 id="一、插件编写语言"><a href="#一、插件编写语言" class="headerlink" title="一、插件编写语言"></a>一、插件编写语言</h2><p>kubernetes 1.12 新的插件机制在编写语言上同以前一样，<strong>可以以任意语言编写，只要能弄一个可执行的文件出来就行</strong>，插件可以是一个 <code>bash</code>、<code>python</code> 脚本，也可以是 <code>Go</code> 等编译语言最终编译的二进制；以下是一个 Copy 自官方文档的 <code>bash</code> 编写的插件样例</p>
<div class="hljs"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># optional argument handling</span>
<span class="hljs-keyword">if</span> [[ <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> == <span class="hljs-string">"version"</span> ]]
<span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"1.0.0"</span>
    <span class="hljs-built_in">exit</span> 0
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># optional argument handling</span>
<span class="hljs-keyword">if</span> [[ <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> == <span class="hljs-string">"config"</span> ]]
<span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$KUBECONFIG</span>
    <span class="hljs-built_in">exit</span> 0
<span class="hljs-keyword">fi</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"I am a plugin named kubectl-foo"</span></code></pre></div>

<h2 id="二、插件加载方式"><a href="#二、插件加载方式" class="headerlink" title="二、插件加载方式"></a>二、插件加载方式</h2><h3 id="2-1、插件位置"><a href="#2-1、插件位置" class="headerlink" title="2.1、插件位置"></a>2.1、插件位置</h3><p>1.12 kubectl 插件最大的变化就是加载方式变了，由原来的放置在指定位置，还要为其编写 yaml 配置变成了现在的类似 git 扩展命令的方式: <strong>只要放置在 PATH 下，并以 <code>kubectl-</code> 开头的可执行文件都被认为是 <code>kubectl</code> 的插件</strong>；所以你可以随便弄个小脚本(比如上面的代码)，然后改好名字赋予可执行权限，扔到 PATH 下即可</p>
<p><img src="https://cdn.oss.link/markdown/s64v6.png" srcset="/img/loading.gif" alt="test-plugin"></p>
<h3 id="2-2、插件变量"><a href="#2-2、插件变量" class="headerlink" title="2.2、插件变量"></a>2.2、插件变量</h3><p>同以前不通，<strong>以前版本的执行插件时，<code>kubectl</code> 会向插件传递一些特定的与 <code>kubectl</code> 相关的变量，现在则只会传递标准变量；即 <code>kubectl</code> 能读到什么变量，插件就能读到，其他的私有化变量(比如 <code>KUBECTL_PLUGINS_CURRENT_NAMESPACE</code>)不会再提供</strong></p>
<p><img src="https://cdn.oss.link/markdown/vs1c3.png" srcset="/img/loading.gif" alt="plugin env"></p>
<p><strong>并且新版本的插件体系，所有选项(<code>flag</code>) 将全部交由插件本身处理，kubectl 不会再解析</strong>，比如下面的 <code>--help</code> 交给了自定义插件处理，由于脚本内没有处理这个选项，所以相当于选项无效了</p>
<p><img src="https://cdn.oss.link/markdown/8ch88.png" srcset="/img/loading.gif" alt="plugin flag"></p>
<p>还有就是 <strong>传递给插件的第一个参数永远是插件自己的绝对位置，比如这个 <code>test</code> 插件在执行时的 <code>$0</code> 是 <code>/usr/local/bin/kubectl-test</code></strong></p>
<h3 id="2-3、插件命名及查找"><a href="#2-3、插件命名及查找" class="headerlink" title="2.3、插件命名及查找"></a>2.3、插件命名及查找</h3><p>目前在插件命名及查找顺序上官方文档写的非常详尽，不给过对于普通使用者来说，实际上命名规则和查找与常规的 Linux 下的命令查找机制相同，只不过还做了增强；增强后的基本规则如下</p>
<ul>
<li><code>PATH</code> 优先匹配原则</li>
<li>短横线 <code>-</code> 自动分割匹配以及智能转义</li>
<li>以最精确匹配为首要目标</li>
<li>查找失败自动转换参数</li>
</ul>
<p><code>PATH</code> 优先匹配原则跟传统的命令查找一致，即当多个路径下存在同名的插件时，则采用最先查找到的插件</p>
<p><img src="https://cdn.oss.link/markdown/ljyp5.png" srcset="/img/loading.gif" alt="plugin path"></p>
<p>当你的插件文件名中包含 <code>-</code> ，并且 <code>kubectl</code> 在无法精确找到插件时会尝试自动拼接命令来尝试匹配；如下所示，在没有找到 <code>kubectl-test</code> 这个命令时会尝试拼接参数查找</p>
<p><img src="https://cdn.oss.link/markdown/l85bp.png" srcset="/img/loading.gif" alt="auto merge"></p>
<p>由于以上这种查找机制，<strong>当命令中确实包含 <code>-</code> 时，必须进行转义以 <code>_</code> 替换，否则 <code>kubectl</code> 会提示命令未找到错误</strong>；替换后可直接使用 <code>kubectl 插件命令(包含-)</code> 执行，同时也支持以原始插件名称执行(使用 <code>_</code>)</p>
<p><img src="https://cdn.oss.link/markdown/7vm0l.png" srcset="/img/loading.gif" alt="name contains dash"></p>
<p>在复杂插件体系下，多个插件可能包含同样的前缀，此时将遵序最精确查找原则；即当两个插件 <code>kubectl-test-aaa</code>、<code>kubectl-test-aaa-bbb</code> 同时存在，并且执行 <code>kubectl test aaa bbb</code> 命令时，优先匹配最精确的插件 <code>kubectl-test-aaa-bbb</code>，<strong>而不是将 <code>bbb</code> 作为参数传递给 <code>kubectl-test-aaa</code> 插件</strong></p>
<p><img src="https://cdn.oss.link/markdown/god8q.png" srcset="/img/loading.gif" alt="precise search"></p>
<h3 id="2-4、总结"><a href="#2-4、总结" class="headerlink" title="2.4、总结"></a>2.4、总结</h3><p>插件查找机制在一般情况下与传统 PATH 查找方式相同，同时 <code>kubectl</code> 实现了智能的 <code>-</code> 自动匹配查找、更精确的命令命中功能；这两种机制的实现主要为了方便编写插件的命令树(插件命令的子命令…)，类似下面这种</p>
<div class="hljs"><pre><code class="hljs sh">$ ls ./plugin_command_tree
kubectl-parent
kubectl-parent-subcommand
kubectl-parent-subcommand-subsubcommand</code></pre></div>

<p>当出现多个位置有同名插件时，执行 <code>kubectl plugin list</code> 能够检测出哪些插件由于 PATH 查找顺序原因导致永远不会被执行问题</p>
<div class="hljs"><pre><code class="hljs sh">$ kubectl plugin list
The following kubectl-compatible plugins are available:

<span class="hljs-built_in">test</span>/fixtures/pkg/kubectl/plugins/kubectl-foo
/usr/<span class="hljs-built_in">local</span>/bin/kubectl-foo
  - warning: /usr/<span class="hljs-built_in">local</span>/bin/kubectl-foo is overshadowed by a similarly named plugin: <span class="hljs-built_in">test</span>/fixtures/pkg/kubectl/plugins/kubectl-foo
plugins/kubectl-invalid
  - warning: plugins/kubectl-invalid identified as a kubectl plugin, but it is not executable

error: 2 plugin warnings were found</code></pre></div>

<h3 id="三、Golang-的插件辅助库"><a href="#三、Golang-的插件辅助库" class="headerlink" title="三、Golang 的插件辅助库"></a>三、Golang 的插件辅助库</h3><p>由于插件机制的变更，导致其他语言编写的插件在实时获取某些配置信息、动态修改 <code>kubectl</code> 配置方面可能造成一定的阻碍；为此 kubernetes 提供了一个 <a href="https://github.com/kubernetes/cli-runtime" target="_blank" rel="noopener">command line runtime package</a>，使用 Go 编写插件，配合这个库可以更加方便的解析和调整 <code>kubectl</code> 的配置信息</p>
<p>官方为了演示如何使用这个 <a href="https://github.com/kubernetes/cli-runtime" target="_blank" rel="noopener">cli-runtime</a> 库编写了一个 <code>namespace</code> 切换的插件(自己白写了…)，仓库地址在 <a href="https://github.com/kubernetes/sample-cli-plugin" target="_blank" rel="noopener">Github</a> 上，基本编译使用如下(直接 <code>go get</code> 后编译文件默认为目录名 <code>cmd</code>)</p>
<div class="hljs"><pre><code class="hljs sh">➜  ~ go get k8s.io/sample-cli-plugin/cmd
➜  ~ sudo mv gopath/bin/cmd /usr/<span class="hljs-built_in">local</span>/bin/kubectl-ns
➜  ~ kubectl ns
default
➜  ~ kubectl ns --<span class="hljs-built_in">help</span>
View or <span class="hljs-built_in">set</span> the current namespace

Usage:
  ns [new-namespace] [flags]

Examples:

        <span class="hljs-comment"># view the current namespace in your KUBECONFIG</span>
        kubectl ns

        <span class="hljs-comment"># view all of the namespaces in use by contexts in your KUBECONFIG</span>
        kubectl ns --list

        <span class="hljs-comment"># switch your current-context to one that contains the desired namespace</span>
        kubectl ns foo


Flags:
      --as string                      Username to impersonate <span class="hljs-keyword">for</span> the operation
      --as-group stringArray           Group to impersonate <span class="hljs-keyword">for</span> the operation, this flag can be repeated to specify multiple groups.
      --cache-dir string               Default HTTP cache directory (default <span class="hljs-string">"/Users/mritd/.kube/http-cache"</span>)
      --certificate-authority string   Path to a cert file <span class="hljs-keyword">for</span> the certificate authority
      --client-certificate string      Path to a client certificate file <span class="hljs-keyword">for</span> TLS
      --client-key string              Path to a client key file <span class="hljs-keyword">for</span> TLS
      --cluster string                 The name of the kubeconfig cluster to use
      --context string                 The name of the kubeconfig context to use
  -h, --<span class="hljs-built_in">help</span>                           <span class="hljs-built_in">help</span> <span class="hljs-keyword">for</span> ns
      --insecure-skip-tls-verify       If <span class="hljs-literal">true</span>, the server<span class="hljs-string">'s certificate will not be checked for validity. This will make your HTTPS connections insecure</span>
<span class="hljs-string">      --kubeconfig string              Path to the kubeconfig file to use for CLI requests.</span>
<span class="hljs-string">      --list                           if true, print the list of all namespaces in the current KUBECONFIG</span>
<span class="hljs-string">  -n, --namespace string               If present, the namespace scope for this CLI request</span>
<span class="hljs-string">      --request-timeout string         The length of time to wait before giving up on a single server request. Non-zero values should contain a corresponding time unit (e.g. 1s, 2m, 3h). A value of zero means don'</span>t timeout requests. (default <span class="hljs-string">"0"</span>)
  -s, --server string                  The address and port of the Kubernetes API server
      --token string                   Bearer token <span class="hljs-keyword">for</span> authentication to the API server
      --user string                    The name of the kubeconfig user to use</code></pre></div>

<p>限于篇幅原因，具体这个 <code>cli-runtime</code> 包怎么用请自行参考官方写的这个 <code>sample-cli-plugin</code> (其实并不怎么 “simple”…)</p>
<p>本文参考文档:</p>
<ul>
<li><a href="https://kubernetes.io/docs/tasks/extend-kubectl/kubectl-plugins/" target="_blank" rel="noopener">Extend kubectl with plugins</a></li>
<li><a href="https://github.com/kubernetes/cli-runtime" target="_blank" rel="noopener">cli-runtime</a></li>
<li><a href="https://github.com/kubernetes/sample-cli-plugin" target="_blank" rel="noopener">sample-cli-plugin</a></li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/kubernetes/">Kubernetes</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/kubernetes/">Kubernetes</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a rel="license noopener" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 国际许可协议进行许可，转载请注明出处。</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2019/01/16/understand-kubernetes-sample-cli-plugin-source-code/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Kubernetes sample-cli-plugin 源码分析</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2018/11/27/simple-tool-written-in-golang/">
                        <span class="hidden-mobile">Go 编写的一些常用小工具</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments">
                
                
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'https://mritd.com/2018/11/30/kubectl-plugin-new-solution-on-kubernetes-1.12/';
        this.page.identifier = '/2018/11/30/kubectl-plugin-new-solution-on-kubernetes-1.12/';
      };
      function loadDisqus() {
        (function () {
          var d = document,
            s = d.createElement('script');
          s.src = '//' + 'mritd' + '.disqus.com/embed.js';
          s.setAttribute('data-timestamp', new Date());
          (d.head || d.body).appendChild(s);
        })();
      }
      waitElementVisible('disqus_thread', loadDisqus);
    </script>
    <noscript>Please enable JavaScript to view the
      <a href="https://disqus.com/?ref_noscript" target="_blank" rel="nofollow noopener noopener">comments powered by Disqus.</a>
    </noscript>
  </div>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '#post-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 3,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Kubernetes 1.12 新的插件机制&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 80,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
      icon: "❡"
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>




















</body>
</html>
