<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png"><link rel="icon" href="/img/favicon.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="Kovacs"><meta name="keywords" content="Kubernetes,HA,kubeadm"><meta name="description" content="真是不巧，刚折腾完 kubeadm 搭建集群(v1.17.0)，第二天早上醒来特么的 v1.17.1 发布了；这我能忍么，肯定不能忍，然后就开始了集群升级之路..."><meta property="og:type" content="article"><meta property="og:title" content="kubeadm 集群升级"><meta property="og:url" content="https://mritd.com/2020/01/21/how-to-upgrade-kubeadm-cluster/index.html"><meta property="og:site_name" content="Kovacs"><meta property="og:description" content="真是不巧，刚折腾完 kubeadm 搭建集群(v1.17.0)，第二天早上醒来特么的 v1.17.1 发布了；这我能忍么，肯定不能忍，然后就开始了集群升级之路..."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://mritd.com/img/kubeadm_upgrade.jpg"><meta property="article:published_time" content="2020-01-21T04:41:46.000Z"><meta property="article:modified_time" content="2020-01-21T04:41:46.000Z"><meta property="article:author" content="Kovacs"><meta property="article:tag" content="Kubernetes"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://mritd.com/img/kubeadm_upgrade.jpg"><meta name="twitter:creator" content="@kovacs_orz"><meta name="twitter:site" content="https://twitter.com/kovacs_orz"><title>kubeadm 集群升级 - Kovacs</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"mritd.com",root:"/",version:"1.9.7",typing:{enable:!0,typeSpeed:80,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:"❡"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!0,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:3},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:null,google:{measurement_id:"G-H06NPECR0Z"},tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=G-H06NPECR0Z",(function(){function a(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],a("js",new Date),a("config","G-H06NPECR0Z")}))</script><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="Kovacs" type="application/atom+xml">
<link rel="alternate" href="/rss.xml" title="Kovacs" type="application/rss+xml">
</head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Kovacs</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item"><a class="nav-link" href="/friends/" target="_self"><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="kubeadm 集群升级"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> Kovacs </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2020-01-21 12:41" pubdate>2020年1月21日 下午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 1.5k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 13 分钟</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">kubeadm 集群升级</h1><div class="markdown-body"><h2 id="一、升级前准备"><a href="#一、升级前准备" class="headerlink" title="一、升级前准备"></a>一、升级前准备</h2><ul><li>确保你的集群是 kubeadm 搭建的(等同于废话)</li><li>确保当前集群已经完成 HA(多个 master 节点)</li><li>确保在夜深人静的时候(无大量业务流量)</li><li>确保集群版本大于 v1.16.0</li><li>确保已经仔细阅读了目标版本 CHANGELOG</li><li>确保做好了完整地集群备份</li></ul><h2 id="二、升级注意事项"><a href="#二、升级注意事项" class="headerlink" title="二、升级注意事项"></a>二、升级注意事项</h2><ul><li>升级后所有集群组件 Pod 会重启(hash 变更)</li><li><strong>升级时 <code>kubeadm</code> 版本必须大于或等于目标版本</strong></li><li><strong>升级期间所有 <code>kube-proxy</code> 组件会有一次全节点滚动更新</strong></li><li><strong>升级只支持顺次进行，不支持跨版本升级(You only can upgrade from one MINOR version to the next MINOR version, or between PATCH versions of the same MINOR. That is, you cannot skip MINOR versions when you upgrade. For example, you can upgrade from 1.y to 1.y+1, but not from 1.y to 1.y+2.)</strong></li></ul><p>关于升级版本问题…虽然是这么说的，但是官方文档样例代码里是从 <code>v1.16.0</code> 升级到 <code>v1.17.0</code>；可能是我理解有误，跨大版本升级好像官方没提，具体啥后果不清楚…</p><h2 id="三、升级-Master"><a href="#三、升级-Master" class="headerlink" title="三、升级 Master"></a>三、升级 Master</h2><blockquote><p>事实上所有升级工作主要是针对 master 节点做的，所以整个升级流程中最重要的是如何把 master 升级好。</p></blockquote><h3 id="3-1、升级-kubeadm、kubectl"><a href="#3-1、升级-kubeadm、kubectl" class="headerlink" title="3.1、升级 kubeadm、kubectl"></a>3.1、升级 kubeadm、kubectl</h3><p>首先由于升级限制，必须先将 <code>kubeadm</code> 和 <code>kubectl</code> 升级到大于等于目标版本</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># replace x in 1.17.x-00 with the latest patch version</span><br>apt-mark unhold kubeadm kubectl<br>apt-get update<br>apt-get install -y kubeadm=1.17.x-00 kubectl=1.17.x-00<br>apt-mark hold kubeadm kubectl<br></code></pre></td></tr></table></figure><p>当然如果你之前没有 <code>hold</code> 住这几个软件包的版本，那么就不需要 <code>unhold</code>；我的做法可能比较极端…一般为了防止后面的误升级安装完成后我会直接 <code>rename</code> 掉相关软件包的 <code>apt source</code> 配置(从根本上防止手贱)。</p><h3 id="3-2、升级前准备"><a href="#3-2、升级前准备" class="headerlink" title="3.2、升级前准备"></a>3.2、升级前准备</h3><h4 id="3-2-1、配置修改"><a href="#3-2-1、配置修改" class="headerlink" title="3.2.1、配置修改"></a>3.2.1、配置修改</h4><p>对于高级玩家一般安装集群时都会自定义很多组件参数，此时不可避免的会采用配置文件；所以安装完新版本的 <code>kubeadm</code> 后就要着手修改配置文件中的 <code>kubernetesVersion</code> 字段为目标集群版本，当然有其他变更也可以一起修改。</p><h4 id="3-2-2、节点驱逐"><a href="#3-2-2、节点驱逐" class="headerlink" title="3.2.2、节点驱逐"></a>3.2.2、节点驱逐</h4><p>如果你的 master 节点也当作 node 在跑一些工作负载，则需要执行以下命令驱逐这些 pod 并使节点进入维护模式(禁止调度)。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># 将 NODE_NAME 换成 Master 节点名称</span><br>kubectl drain NODE_NAME --ignore-daemonsets<br></code></pre></td></tr></table></figure><h4 id="3-2-3、查看升级计划"><a href="#3-2-3、查看升级计划" class="headerlink" title="3.2.3、查看升级计划"></a>3.2.3、查看升级计划</h4><p>完成节点驱逐以后，可以通过以下命令查看升级计划；<strong>升级计划中列出了升级期间要执行的所有步骤以及相关警告，一定要仔细查看。</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs sh">k8s16.node ➜  ~ kubeadm upgrade plan --config /etc/kubernetes/kubeadm.yaml<br>W0115 10:59:52.586204     983 validation.go:28] Cannot validate kube-proxy config - no validator is available<br>W0115 10:59:52.586241     983 validation.go:28] Cannot validate kubelet config - no validator is available<br>[upgrade/config] Making sure the configuration is correct:<br>W0115 10:59:52.605458     983 common.go:94] WARNING: Usage of the --config flag <span class="hljs-keyword">for</span> reconfiguring the cluster during upgrade is not recommended!<br>W0115 10:59:52.607258     983 validation.go:28] Cannot validate kube-proxy config - no validator is available<br>W0115 10:59:52.607274     983 validation.go:28] Cannot validate kubelet config - no validator is available<br>[preflight] Running pre-flight checks.<br>[upgrade] Making sure the cluster is healthy:<br>[upgrade] Fetching available versions to upgrade to<br>[upgrade/versions] Cluster version: v1.17.0<br>[upgrade/versions] kubeadm version: v1.17.1<br><br>External components that should be upgraded manually before you upgrade the control plane with <span class="hljs-string">&#x27;kubeadm upgrade apply&#x27;</span>:<br>COMPONENT   CURRENT   AVAILABLE<br>Etcd        3.3.18    3.4.3-0<br><br>Components that must be upgraded manually after you have upgraded the control plane with <span class="hljs-string">&#x27;kubeadm upgrade apply&#x27;</span>:<br>COMPONENT   CURRENT       AVAILABLE<br>Kubelet     5 x v1.17.0   v1.17.1<br><br>Upgrade to the latest version <span class="hljs-keyword">in</span> the v1.17 series:<br><br>COMPONENT            CURRENT   AVAILABLE<br>API Server           v1.17.0   v1.17.1<br>Controller Manager   v1.17.0   v1.17.1<br>Scheduler            v1.17.0   v1.17.1<br>Kube Proxy           v1.17.0   v1.17.1<br>CoreDNS              1.6.5     1.6.5<br><br>You can now apply the upgrade by executing the following <span class="hljs-built_in">command</span>:<br><br>        kubeadm upgrade apply v1.17.1<br><br>_____________________________________________________________________<br></code></pre></td></tr></table></figure><h3 id="3-3、执行升级"><a href="#3-3、执行升级" class="headerlink" title="3.3、执行升级"></a>3.3、执行升级</h3><p>确认好升级计划以后，只需要一条命令既可将当前 master 节点升级到目标版本</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">kubeadm upgrade apply v1.17.1 --config /etc/kubernetes/kubeadm.yaml<br></code></pre></td></tr></table></figure><p>升级期间会打印很详细的日志，在日志中可以实时观察到升级流程，建议仔细关注升级流程；<strong>在最后一步会有一条日志 <code>[addons] Applied essential addon: kube-proxy</code>，这意味着集群开始更新 <code>kube-proxy</code> 组件，该组件目前是通过 <code>daemonset</code> 方式启动的；这会意味着此时会造成全节点的 <code>kube-proxy</code> 更新；</strong>理论上不会有很大影响，但是升级是还是需要注意一下这一步操作，在我的观察中似乎 <code>kube-proxy</code> 也是通过滚动更新完成的，所以问题应该不大。</p><h3 id="3-4、升级-kubelet"><a href="#3-4、升级-kubelet" class="headerlink" title="3.4、升级 kubelet"></a>3.4、升级 kubelet</h3><p>在单个 master 上升级完成后，<strong>只会升级本节点的 master 相关组件和全节点的 <code>kube-proxy</code> 组件；</strong>由于 kubelet 是在宿主机安装的，所以需要通过包管理器手动升级 kubelet</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># replace x in 1.17.x-00 with the latest patch version</span><br>apt-mark unhold kubelet<br>apt-get install -y kubelet=1.17.x-00<br>apt-mark hold kubelet<br></code></pre></td></tr></table></figure><p>更新完成后执行 <code>systemctl restart kubelet</code> 重启，并等待启动成功既可；最后不要忘记解除当前节点的维护模式(<code>uncordon</code>)。</p><h3 id="3-5、升级其他-Master"><a href="#3-5、升级其他-Master" class="headerlink" title="3.5、升级其他 Master"></a>3.5、升级其他 Master</h3><p>当其中一个 master 节点升级完成后，其他的 master 升级就会相对简单的多；<strong>首先国际惯例升级一下 <code>kubeadm</code> 和 <code>kubectl</code> 软件包，然后直接在其他 master 节点执行 <code>kubeadm upgrade node</code> 既可。</strong>由于 apiserver 等组件配置已经在升级第一个 master 时上传到了集群的 configMap 中，所以事实上其他 master 节点只是正常拉取然后重启相关组件既可；这一步同样会输出详细日志，可以仔细观察进度，<strong>最后不要忘记升级之前先进入维护模式，升级完成后重新安装 <code>kubelet</code> 并关闭节点维护模式。</strong></p><h2 id="四、升级-Node"><a href="#四、升级-Node" class="headerlink" title="四、升级 Node"></a>四、升级 Node</h2><p>node 节点的升级实际上在升级完 master 节点以后不需要什么特殊操作，node 节点唯一需要升级的就是 <code>kubelet</code> 组件；<strong>首先在 node 节点执行 <code>kubeadm upgrade node</code> 命令，该命令会拉取集群内的 <code>kubelet</code> 配置文件，然后重新安装 <code>kubelet</code> 重启既可；</strong>同样升级 node 节点时不要忘记开启维护模式。针对于 CNI 组件请按需手动升级，并且确认好 CNI 组件的兼容版本。</p><h2 id="五、验证集群"><a href="#五、验证集群" class="headerlink" title="五、验证集群"></a>五、验证集群</h2><p>所有组件升级完成后，可以通过 <code>kubectl describe POD_NAME</code> 的方式验证 master 组件是否都升级到了最新版本；通过 <code>kuebctl version</code> 命令验证 api 相关信息(HA rr 轮训模式下可以多执行几遍)；还有就是通过 <code>kubectl get node -o wide</code> 查看相关 node 的信息，确保 <code>kubelet</code> 都升级成功，同时全部节点维护模式都已经关闭，其他细节可以参考<a target="_blank" rel="noopener" href="https://kubernetes.io/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade">官方文档</a>。</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/kubernetes/" class="category-chain-item">Kubernetes</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/kubernetes/" class="print-no-link">#Kubernetes</a></div></div><div class="license-box my-3"><div class="license-title"><div>kubeadm 集群升级</div><div>https://mritd.com/2020/01/21/how-to-upgrade-kubeadm-cluster/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Kovacs</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2020年1月21日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i> </span></a><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - 非商业性使用"><i class="iconfont icon-nc"></i> </span></a><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2020/01/21/how-to-extend-the-validity-of-your-kubeadm-certificate/" title="kubeadm 证书期限调整"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">kubeadm 证书期限调整</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2020/01/21/set-up-kubernetes-ha-cluster-by-kubeadm/" title="kubeadm 搭建 HA kubernetes 集群"><span class="hidden-mobile">kubeadm 搭建 HA kubernetes 集群</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div class="disqus" style="width:100%"><div id="disqus_thread"></div><script type="text/javascript">var disqus_config=function(){this.page.url="https://mritd.com/2020/01/21/how-to-upgrade-kubeadm-cluster/",this.page.identifier="/2020/01/21/how-to-upgrade-kubeadm-cluster/"};Fluid.utils.loadComments("#disqus_thread",(function(){var e=document,t=e.createElement("script");t.src="//bleem.disqus.com/embed.js",t.setAttribute("data-timestamp",new Date),(e.head||e.body).appendChild(t)}))</script><noscript>Please enable JavaScript to view the comments</noscript></div></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <i class="iconfont icon-docker"></i> <a href="https://bandwagonhost.com/aff.php?aff=61367" target="_blank" rel="nofollow noopener"><span>BandwagonHost</span></a></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!0,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>